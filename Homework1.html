
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Homework 1 - Digital Communications 2022-2 Universidad de Antioquia &#8212; Natural Lenguage Processing</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo_udea.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Natural Lenguage Processing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="content/intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="content/markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="content/notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="content/markdown-notebooks.html">
   Notebooks with MyST Markdown
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://colab.research.google.com/github/fredydo/NaturalLenguageProcessing/blob/master/Homework1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/fredydo/NaturalLenguageProcessing"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/fredydo/NaturalLenguageProcessing/issues/new?title=Issue%20on%20page%20%2FHomework1.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Homework1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   1.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-plot-the-histogram-of-y">
     a. Plot the histogram of
     <span class="math notranslate nohighlight">
      \(Y\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-calculate-the-p-y-25-in-simulated-array">
     b. Calculate the
     <span class="math notranslate nohighlight">
      \(P(Y ≥ 25)\)
     </span>
     in simulated array
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-find-f-y-y-using-the-convolution-of-f-x-1-x-1-f-x-2-x-2-and-f-x-3-x-3-and-plot-the-result-plot-f-y-y-and-compare-with-histogram">
     c. Find
     <span class="math notranslate nohighlight">
      \(f_Y(y)\)
     </span>
     using the convolution of
     <span class="math notranslate nohighlight">
      \(f_{X_1}(x_1)\)
     </span>
     ,
     <span class="math notranslate nohighlight">
      \(f_{X_2}(x_2)\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(f_{X_3}(x_3)\)
     </span>
     , and plot the result. Plot
     <span class="math notranslate nohighlight">
      \(f_y(y)\)
     </span>
     and compare with histogram.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   2.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-8-0-8-0-8-1-8-calculate-the-probabilities-p-x-i-y-from-bayes-theorem-and-decide-the-most-likely-received-symbol">
     a. Four symbols are transmitted, and assume that the received signal is
     <span class="math notranslate nohighlight">
      \(Y = \{−1.8, −0.8, 0.8, 1.8\}\)
     </span>
     . Calculate the probabilities
     <span class="math notranslate nohighlight">
      \(P(X_i|Y )\)
     </span>
     from Bayes theorem, and decide the most likely received symbol.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-generate-x-1000-times-1-operatorname-train-input-symbols-an-the-correspondent-received-sequence-from-the-channel-y-1000-times-1-operatorname-train-based-on-the-distribution-f-y-x-i-use-gaussiannb-from-sklearn-library-to-estimate-predict-the-most-likely-received-symbol-from-y-1-8-0-8-0-8-1-8-compare-with-previous-result">
     b. Generate
     <span class="math notranslate nohighlight">
      \(X_{1000 \times 1}^{\operatorname{train}}\)
     </span>
     input symbols an the correspondent received sequence from the channel
     <span class="math notranslate nohighlight">
      \(Y_{1000 \times 1}^{\operatorname{train}}\)
     </span>
     , based on the distribution
     <span class="math notranslate nohighlight">
      \(f(Y |X_i)\)
     </span>
     . Use
     <code class="docutils literal notranslate">
      <span class="pre">
       GaussianNB
      </span>
     </code>
     from
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn
      </span>
     </code>
     library to estimate(
     <code class="docutils literal notranslate">
      <span class="pre">
       predict
      </span>
     </code>
     ) the most likely received symbol from
     <span class="math notranslate nohighlight">
      \(Y = \{−1.8, −0.8, 0.8, 1.8\}\)
     </span>
     . Compare with previous result.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   3.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-plot-the-sequences-x-100-times-2-1-x-100-times-2-2-scatter-plot">
     a. Plot the sequences
     <span class="math notranslate nohighlight">
      \(X_{100 \times 2}^1, X_{100 \times 2}^2\)
     </span>
     (scatter plot)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-4-4-2-0-2-1-3-5-use-gaussiannb-from-sklearn-library-to-estimate-command-predict-the-most-likely-received-symbols">
     b. Four symbols are transmitted, and assume that the received signal is
     <span class="math notranslate nohighlight">
      \(Y = \{[1, 4], [4, −2], [0, 2], [1, 3.5]\}\)
     </span>
     . Use
     <code class="docutils literal notranslate">
      <span class="pre">
       GaussianNB
      </span>
     </code>
     from
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn
      </span>
     </code>
     library to estimate (command
     <code class="docutils literal notranslate">
      <span class="pre">
       predict
      </span>
     </code>
     ) the most likely received symbols.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   4.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-plot-the-ensemble-and-time-average-is-the-process-ergodic-in-the-mean">
     a. plot the ensemble and time average. Is the process ergodic in the mean?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-plot-the-ensemble-and-time-autocorrelation-function-is-the-process-ergodic-in-the-autocorrelation">
     b. plot the ensemble and time autocorrelation function. Is the process ergodic in the autocorrelation?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-find-the-autocorrelation-function-r-xx-using-signal-correlate-and-plot-the-result-compare-the-maximum-value-of-r-xx-with-the-noise-power-in-bandwidth-frac-f-s-cdot-n-0-2">
     a. Find the autocorrelation function
     <span class="math notranslate nohighlight">
      \(R_{XX}(τ)\)
     </span>
     , using
     <code class="docutils literal notranslate">
      <span class="pre">
       signal.correlate
      </span>
     </code>
     , and plot the result. Compare the maximum value of
     <span class="math notranslate nohighlight">
      \(R_{XX}(τ)\)
     </span>
     with the noise power in bandwidth:
     <span class="math notranslate nohighlight">
      \(\frac{f_s \cdot N_0}{2}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-find-the-power-spectral-density-with">
     b. Find the power spectral density with:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   6.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-add-the-gaussian-noise-correspondent-to-a-snr-1db-and-plot-x-t-and-y-t">
     a. Add the gaussian noise correspondent to a
     <span class="math notranslate nohighlight">
      \(SNR=-1dB\)
     </span>
     , and plot
     <span class="math notranslate nohighlight">
      \(X(t)\)
     </span>
     , and
     <span class="math notranslate nohighlight">
      \(Y(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-plot-the-autocorrelation-functions-r-xx-and-r-yy">
     b. Plot the autocorrelation functions
     <span class="math notranslate nohighlight">
      \(R_{XX}\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(R_{YY}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-plot-the-power-spectral-densities-s-xx-and-s-yy">
     c. Plot the power spectral densities
     <span class="math notranslate nohighlight">
      \(S_{XX}\)
     </span>
     , and
     <span class="math notranslate nohighlight">
      \(S_{YY}\)
     </span>
     .
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   7.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-determine-the-coefficients-of-the-ar-4-estimator-of-x-t-using-the-yule-walker-equations">
     a. Determine the coefficients of the
     <span class="math notranslate nohighlight">
      \(AR(4)\)
     </span>
     estimator of
     <span class="math notranslate nohighlight">
      \(x(t)\)
     </span>
     , using the Yule Walker equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-plot-the-estimated-psd-psd-command-and-the-parametric-psd-from-yule-walker-equations">
     b. Plot the estimated PSD (
     <code class="docutils literal notranslate">
      <span class="pre">
       psd
      </span>
     </code>
     command), and the parametric PSD from Yule Walker equations
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Homework 1 - Digital Communications 2022-2 Universidad de Antioquia</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   1.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-plot-the-histogram-of-y">
     a. Plot the histogram of
     <span class="math notranslate nohighlight">
      \(Y\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-calculate-the-p-y-25-in-simulated-array">
     b. Calculate the
     <span class="math notranslate nohighlight">
      \(P(Y ≥ 25)\)
     </span>
     in simulated array
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-find-f-y-y-using-the-convolution-of-f-x-1-x-1-f-x-2-x-2-and-f-x-3-x-3-and-plot-the-result-plot-f-y-y-and-compare-with-histogram">
     c. Find
     <span class="math notranslate nohighlight">
      \(f_Y(y)\)
     </span>
     using the convolution of
     <span class="math notranslate nohighlight">
      \(f_{X_1}(x_1)\)
     </span>
     ,
     <span class="math notranslate nohighlight">
      \(f_{X_2}(x_2)\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(f_{X_3}(x_3)\)
     </span>
     , and plot the result. Plot
     <span class="math notranslate nohighlight">
      \(f_y(y)\)
     </span>
     and compare with histogram.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   2.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-8-0-8-0-8-1-8-calculate-the-probabilities-p-x-i-y-from-bayes-theorem-and-decide-the-most-likely-received-symbol">
     a. Four symbols are transmitted, and assume that the received signal is
     <span class="math notranslate nohighlight">
      \(Y = \{−1.8, −0.8, 0.8, 1.8\}\)
     </span>
     . Calculate the probabilities
     <span class="math notranslate nohighlight">
      \(P(X_i|Y )\)
     </span>
     from Bayes theorem, and decide the most likely received symbol.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-generate-x-1000-times-1-operatorname-train-input-symbols-an-the-correspondent-received-sequence-from-the-channel-y-1000-times-1-operatorname-train-based-on-the-distribution-f-y-x-i-use-gaussiannb-from-sklearn-library-to-estimate-predict-the-most-likely-received-symbol-from-y-1-8-0-8-0-8-1-8-compare-with-previous-result">
     b. Generate
     <span class="math notranslate nohighlight">
      \(X_{1000 \times 1}^{\operatorname{train}}\)
     </span>
     input symbols an the correspondent received sequence from the channel
     <span class="math notranslate nohighlight">
      \(Y_{1000 \times 1}^{\operatorname{train}}\)
     </span>
     , based on the distribution
     <span class="math notranslate nohighlight">
      \(f(Y |X_i)\)
     </span>
     . Use
     <code class="docutils literal notranslate">
      <span class="pre">
       GaussianNB
      </span>
     </code>
     from
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn
      </span>
     </code>
     library to estimate(
     <code class="docutils literal notranslate">
      <span class="pre">
       predict
      </span>
     </code>
     ) the most likely received symbol from
     <span class="math notranslate nohighlight">
      \(Y = \{−1.8, −0.8, 0.8, 1.8\}\)
     </span>
     . Compare with previous result.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   3.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-plot-the-sequences-x-100-times-2-1-x-100-times-2-2-scatter-plot">
     a. Plot the sequences
     <span class="math notranslate nohighlight">
      \(X_{100 \times 2}^1, X_{100 \times 2}^2\)
     </span>
     (scatter plot)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-4-4-2-0-2-1-3-5-use-gaussiannb-from-sklearn-library-to-estimate-command-predict-the-most-likely-received-symbols">
     b. Four symbols are transmitted, and assume that the received signal is
     <span class="math notranslate nohighlight">
      \(Y = \{[1, 4], [4, −2], [0, 2], [1, 3.5]\}\)
     </span>
     . Use
     <code class="docutils literal notranslate">
      <span class="pre">
       GaussianNB
      </span>
     </code>
     from
     <code class="docutils literal notranslate">
      <span class="pre">
       sklearn
      </span>
     </code>
     library to estimate (command
     <code class="docutils literal notranslate">
      <span class="pre">
       predict
      </span>
     </code>
     ) the most likely received symbols.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   4.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-plot-the-ensemble-and-time-average-is-the-process-ergodic-in-the-mean">
     a. plot the ensemble and time average. Is the process ergodic in the mean?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-plot-the-ensemble-and-time-autocorrelation-function-is-the-process-ergodic-in-the-autocorrelation">
     b. plot the ensemble and time autocorrelation function. Is the process ergodic in the autocorrelation?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   5.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-find-the-autocorrelation-function-r-xx-using-signal-correlate-and-plot-the-result-compare-the-maximum-value-of-r-xx-with-the-noise-power-in-bandwidth-frac-f-s-cdot-n-0-2">
     a. Find the autocorrelation function
     <span class="math notranslate nohighlight">
      \(R_{XX}(τ)\)
     </span>
     , using
     <code class="docutils literal notranslate">
      <span class="pre">
       signal.correlate
      </span>
     </code>
     , and plot the result. Compare the maximum value of
     <span class="math notranslate nohighlight">
      \(R_{XX}(τ)\)
     </span>
     with the noise power in bandwidth:
     <span class="math notranslate nohighlight">
      \(\frac{f_s \cdot N_0}{2}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-find-the-power-spectral-density-with">
     b. Find the power spectral density with:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   6.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-add-the-gaussian-noise-correspondent-to-a-snr-1db-and-plot-x-t-and-y-t">
     a. Add the gaussian noise correspondent to a
     <span class="math notranslate nohighlight">
      \(SNR=-1dB\)
     </span>
     , and plot
     <span class="math notranslate nohighlight">
      \(X(t)\)
     </span>
     , and
     <span class="math notranslate nohighlight">
      \(Y(t)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-plot-the-autocorrelation-functions-r-xx-and-r-yy">
     b. Plot the autocorrelation functions
     <span class="math notranslate nohighlight">
      \(R_{XX}\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(R_{YY}\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-plot-the-power-spectral-densities-s-xx-and-s-yy">
     c. Plot the power spectral densities
     <span class="math notranslate nohighlight">
      \(S_{XX}\)
     </span>
     , and
     <span class="math notranslate nohighlight">
      \(S_{YY}\)
     </span>
     .
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   7.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-determine-the-coefficients-of-the-ar-4-estimator-of-x-t-using-the-yule-walker-equations">
     a. Determine the coefficients of the
     <span class="math notranslate nohighlight">
      \(AR(4)\)
     </span>
     estimator of
     <span class="math notranslate nohighlight">
      \(x(t)\)
     </span>
     , using the Yule Walker equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-plot-the-estimated-psd-psd-command-and-the-parametric-psd-from-yule-walker-equations">
     b. Plot the estimated PSD (
     <code class="docutils literal notranslate">
      <span class="pre">
       psd
      </span>
     </code>
     command), and the parametric PSD from Yule Walker equations
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="homework-1-digital-communications-2022-2-universidad-de-antioquia">
<h1>Homework 1 - Digital Communications 2022-2 Universidad de Antioquia<a class="headerlink" href="#homework-1-digital-communications-2022-2-universidad-de-antioquia" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h2>1.<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>The total delay of three signals is <span class="math notranslate nohighlight">\(Y = X_1 + X_2 + X_3\)</span>,
where <span class="math notranslate nohighlight">\(X_1 ∼ U(1, 10)\)</span>, <span class="math notranslate nohighlight">\(X_2 ∼ U(5, 15)\)</span>, and <span class="math notranslate nohighlight">\(X_3 ∼ U(7, 20)\)</span>.<br />
Simulate the total delay <span class="math notranslate nohighlight">\(Y\)</span> , with the sum of three random vectors of size 10000, using <code class="docutils literal notranslate"><span class="pre">scipy.stats.uniform</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>  

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">x1</span><span class="o">=</span><span class="n">uniform</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">x2</span><span class="o">=</span><span class="n">uniform</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">x3</span><span class="o">=</span><span class="n">uniform</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="o">+</span> <span class="n">x3</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

<span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((10000,), 44.14796432898352)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signals&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x1</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$f_</span><span class="si">{x_1}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$f_</span><span class="si">{x_2}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$f_</span><span class="si">{x_3}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$Y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_4_0.png" src="_images/Homework1_4_0.png" />
</div>
</div>
<section id="a-plot-the-histogram-of-y">
<h3>a. Plot the histogram of <span class="math notranslate nohighlight">\(Y\)</span><a class="headerlink" href="#a-plot-the-histogram-of-y" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of $Y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_6_0.png" src="_images/Homework1_6_0.png" />
</div>
</div>
</section>
<section id="b-calculate-the-p-y-25-in-simulated-array">
<h3>b. Calculate the <span class="math notranslate nohighlight">\(P(Y ≥ 25)\)</span> in simulated array<a class="headerlink" href="#b-calculate-the-p-y-25-in-simulated-array" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;P(Y ≥ 25) = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;</span><span class="mi">25</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Y ≥ 25) = 0.7537
</pre></div>
</div>
</div>
</div>
</section>
<section id="c-find-f-y-y-using-the-convolution-of-f-x-1-x-1-f-x-2-x-2-and-f-x-3-x-3-and-plot-the-result-plot-f-y-y-and-compare-with-histogram">
<h3>c. Find <span class="math notranslate nohighlight">\(f_Y(y)\)</span> using the convolution of <span class="math notranslate nohighlight">\(f_{X_1}(x_1)\)</span>, <span class="math notranslate nohighlight">\(f_{X_2}(x_2)\)</span> and <span class="math notranslate nohighlight">\(f_{X_3}(x_3)\)</span>, and plot the result. Plot <span class="math notranslate nohighlight">\(f_y(y)\)</span> and compare with histogram.<a class="headerlink" href="#c-find-f-y-y-using-the-convolution-of-f-x-1-x-1-f-x-2-x-2-and-f-x-3-x-3-and-plot-the-result-plot-f-y-y-and-compare-with-histogram" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">x2_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">x3_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">y_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">px1</span> <span class="o">=</span> <span class="n">x1</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x1_range</span><span class="p">)</span>
<span class="n">px2</span> <span class="o">=</span> <span class="n">x2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x2_range</span><span class="p">)</span>
<span class="n">px3</span> <span class="o">=</span> <span class="n">x3</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x3_range</span><span class="p">)</span>

<span class="n">fy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">px1</span><span class="p">,</span> <span class="n">px2</span><span class="p">,</span> <span class="p">)</span>
<span class="n">fy</span> <span class="o">*=</span> <span class="mf">0.01</span>
<span class="n">fy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">fy</span><span class="p">,</span> <span class="n">px3</span><span class="p">)</span>
<span class="n">fy</span> <span class="o">*=</span> <span class="mf">0.01</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">fy</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Convolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$Y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f_Y(y)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_10_0.png" src="_images/Homework1_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Histogram of $Y$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_range</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="n">fy</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$f_Y(y)$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_11_0.png" src="_images/Homework1_11_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;P(Y ≥ 25) = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">fy</span><span class="p">[</span><span class="n">y_range</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(Y ≥ 25) = 75.88320085470103
</pre></div>
</div>
</div>
</div>
<p>The probability <span class="math notranslate nohighlight">\(P(Y ≥ 25)\)</span> in the histogram and the convolution is almost the same in the both results, <span class="math notranslate nohighlight">\(75.8\%\)</span></p>
</section>
</section>
<section id="id2">
<h2>2.<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>A source generates four symbols <span class="math notranslate nohighlight">\(X = \{−2, −1, 0, 1\}\)</span> with <span class="math notranslate nohighlight">\(p_X = \{0.5, 0.25, 0.15, 0.1\}\)</span>. A channel affects the reception of each symbol with the following conditional densities <span class="math notranslate nohighlight">\(Y|X_1 ∼ N(−2, 1), Y |X_2 ∼ N(−1, 0.5), Y |X_3 ∼ N(0, 0.3),\)</span> and <span class="math notranslate nohighlight">\(Y|X_4 ∼ N(1, 0.7)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span> 

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">px</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>

<span class="n">xva</span> <span class="o">=</span> <span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
       <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
       <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
       <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<section id="a-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-8-0-8-0-8-1-8-calculate-the-probabilities-p-x-i-y-from-bayes-theorem-and-decide-the-most-likely-received-symbol">
<h3>a. Four symbols are transmitted, and assume that the received signal is <span class="math notranslate nohighlight">\(Y = \{−1.8, −0.8, 0.8, 1.8\}\)</span>. Calculate the probabilities <span class="math notranslate nohighlight">\(P(X_i|Y )\)</span> from Bayes theorem, and decide the most likely received symbol.<a class="headerlink" href="#a-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-8-0-8-0-8-1-8-calculate-the-probabilities-p-x-i-y-from-bayes-theorem-and-decide-the-most-likely-received-symbol" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.core.fromnumeric</span> <span class="kn">import</span> <span class="n">argmax</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">]</span>
<span class="n">xh</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">Pmax</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">transmitted_symbol</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">xva</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">py</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">xva</span><span class="p">):</span>
        <span class="n">py</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
            <span class="n">p_aux</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                <span class="n">p_aux</span> <span class="o">+=</span> <span class="n">px</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">xva</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">py</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_aux</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">py</span>

    <span class="n">p_y</span> <span class="o">=</span> <span class="n">py</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">xva</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_y</span><span class="p">)):</span>
        <span class="n">p_aux</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Calculation of probabilities with = </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">px</span><span class="p">)):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">px</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">xva</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">p_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">p_aux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;P(X = </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s1">2</span><span class="si">}</span><span class="s1"> | Y = </span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">) = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">0.3e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
        <span class="nb">print</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum of the probabilities: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">p_aux</span><span class="p">)</span><span class="si">:</span><span class="s1">5.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Decision Y = </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="n">argmax</span><span class="p">(</span><span class="n">p_aux</span><span class="p">)]</span><span class="si">}</span><span class="s1">, with probability </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">p_aux</span><span class="p">)</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*-&#39;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
        <span class="n">xh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">argmax</span><span class="p">(</span><span class="n">p_aux</span><span class="p">)])</span>
        <span class="n">Pmax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">p_aux</span><span class="p">))</span>

<span class="n">transmitted_symbol</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">xva</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;y</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">yi</span> <span class="si">:</span><span class="s1"> 2</span><span class="si">}</span><span class="s1">, xh</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">xh</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="si">:</span><span class="s1"> 2</span><span class="si">}</span><span class="s1">, Pmax = </span><span class="si">{</span><span class="n">Pmax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calculation of probabilities with = -1.8

P(X = -2 | Y = -1.8) = 7.790e-01
P(X = -1 | Y = -1.8) = 2.210e-01
P(X =  0 | Y = -1.8) = 1.210e-08
P(X =  1 | Y = -1.8) = 7.617e-05

Sum of the probabilities:  1.00

Decision Y = -2, with probability 0.779

*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-

Calculation of probabilities with = -0.8

P(X = -2 | Y = -0.8) = 3.359e-01
P(X = -1 | Y = -0.8) = 6.371e-01
P(X =  0 | Y = -0.8) = 1.972e-02
P(X =  1 | Y = -0.8) = 7.229e-03

Sum of the probabilities:  1.00

Decision Y = -1, with probability 0.637

*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-

Calculation of probabilities with = 0.8

P(X = -2 | Y = 0.8) = 6.119e-02
P(X = -1 | Y = 0.8) = 4.731e-03
P(X =  0 | Y = 0.8) = 8.810e-02
P(X =  1 | Y = 0.8) = 8.460e-01

Sum of the probabilities:  1.00

Decision Y = 1, with probability 0.846

*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-

Calculation of probabilities with = 1.8

P(X = -2 | Y = 1.8) = 4.897e-03
P(X = -1 | Y = 1.8) = 1.037e-06
P(X =  0 | Y = 1.8) = 1.019e-07
P(X =  1 | Y = 1.8) = 9.951e-01

Sum of the probabilities:  1.00

Decision Y = 1, with probability 0.995

*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-

y1 = -1.8, xh1 = -2, Pmax = 0.7789667603476719
y2 = -0.8, xh2 = -1, Pmax = 0.6371118491137151
y3 =  0.8, xh3 =  1, Pmax = 0.8459711800184542
y4 =  1.8, xh4 =  1, Pmax = 0.9951016342624195
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-generate-x-1000-times-1-operatorname-train-input-symbols-an-the-correspondent-received-sequence-from-the-channel-y-1000-times-1-operatorname-train-based-on-the-distribution-f-y-x-i-use-gaussiannb-from-sklearn-library-to-estimate-predict-the-most-likely-received-symbol-from-y-1-8-0-8-0-8-1-8-compare-with-previous-result">
<h3>b. Generate <span class="math notranslate nohighlight">\(X_{1000 \times 1}^{\operatorname{train}}\)</span> input symbols an the correspondent received sequence from the channel <span class="math notranslate nohighlight">\(Y_{1000 \times 1}^{\operatorname{train}}\)</span>, based on the distribution <span class="math notranslate nohighlight">\(f(Y |X_i)\)</span>. Use <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library to estimate(<code class="docutils literal notranslate"><span class="pre">predict</span></code>) the most likely received symbol from <span class="math notranslate nohighlight">\(Y = \{−1.8, −0.8, 0.8, 1.8\}\)</span>. Compare with previous result.<a class="headerlink" href="#b-generate-x-1000-times-1-operatorname-train-input-symbols-an-the-correspondent-received-sequence-from-the-channel-y-1000-times-1-operatorname-train-based-on-the-distribution-f-y-x-i-use-gaussiannb-from-sklearn-library-to-estimate-predict-the-most-likely-received-symbol-from-y-1-8-0-8-0-8-1-8-compare-with-previous-result" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">x_random</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">px</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x_random</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">noise</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_random</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">noise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xva</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">noise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xva</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="o">-</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">noise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xva</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">noise</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xva</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random Symbols&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x_random</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$z(n)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random Symbols with noise&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$n$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$z(n)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_20_0.png" src="_images/Homework1_20_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y_label</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prob</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predictions: </span><span class="si">{</span><span class="n">predictions</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Probabilities: </span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predictions: [-2 -1  1  1]
Probabilities: [0.79633811 0.61836659 0.87601639 0.99433892]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id3">
<h2>3.<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>A source generates two symbols (in two dimenssions) from a correlated bivariate normal distribution, with parameters:</p>
<p>\begin{equation}
\begin{array}{lll}
X=1: &amp; \boldsymbol{\mu}_1=\left[\begin{array}{c}
1 \ -1
\end{array}\right] &amp; \boldsymbol{\Sigma}_1=\left[\begin{array}{cc}
2 &amp; -2 \ -2 &amp; 4
\end{array}\right] \
X=2: &amp; \boldsymbol{\mu}<em>2=\left[\begin{array}{l}
3 \ 3
\end{array}\right] &amp; \boldsymbol{\Sigma}</em>{\mathbf{2}}=\left[\begin{array}{cc}
1 &amp; -1 \
-1 &amp; 4
\end{array}\right]
\end{array}
\end{equation}</p>
<p>Generate <span class="math notranslate nohighlight">\(100\)</span> sequences from each symbol, <span class="math notranslate nohighlight">\(X_{100 \times 2}^1\)</span>
and <span class="math notranslate nohighlight">\(X_{100 \times 2}^2\)</span>, and the received sequence <span class="math notranslate nohighlight">\(Y_{200 \times 2}^{train}\)</span>,
(<code class="docutils literal notranslate"><span class="pre">multivariate_normal</span></code> in <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multivariate_normal</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">mu1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="n">sigm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]);</span> <span class="n">sigm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">xv1</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mu1</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">sigm1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">xv2</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">sigm2</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">xv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">xv1</span><span class="p">,</span> <span class="n">xv2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<section id="a-plot-the-sequences-x-100-times-2-1-x-100-times-2-2-scatter-plot">
<h3>a. Plot the sequences <span class="math notranslate nohighlight">\(X_{100 \times 2}^1, X_{100 \times 2}^2\)</span> (scatter plot)<a class="headerlink" href="#a-plot-the-sequences-x-100-times-2-1-x-100-times-2-2-scatter-plot" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xv1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xv1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Symbol 1&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xv2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xv2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Symbol 2&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_26_0.png" src="_images/Homework1_26_0.png" />
</div>
</div>
</section>
<section id="b-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-4-4-2-0-2-1-3-5-use-gaussiannb-from-sklearn-library-to-estimate-command-predict-the-most-likely-received-symbols">
<h3>b. Four symbols are transmitted, and assume that the received signal is <span class="math notranslate nohighlight">\(Y = \{[1, 4], [4, −2], [0, 2], [1, 3.5]\}\)</span>. Use <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library to estimate (command <code class="docutils literal notranslate"><span class="pre">predict</span></code>) the most likely received symbols.<a class="headerlink" href="#b-four-symbols-are-transmitted-and-assume-that-the-received-signal-is-y-1-4-4-2-0-2-1-3-5-use-gaussiannb-from-sklearn-library-to-estimate-command-predict-the-most-likely-received-symbols" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]])</span>

<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="n">y_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">xv</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span> <span class="n">y_label</span> <span class="o">=</span> <span class="n">y_label</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_label</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.13601516, 0.86398484],
       [0.63055496, 0.36944504],
       [0.96444175, 0.03555825],
       [0.23510769, 0.76489231]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2., 1., 1., 2.])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id4">
<h2>4.<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(X(t) = sin(ω + ϕ)\)</span>, where <span class="math notranslate nohighlight">\(ω ∼ U(8, 12)\)</span> and <span class="math notranslate nohighlight">\(φ ∼ U(0, 2π)\)</span>. Generate <span class="math notranslate nohighlight">\(N = 2000\)</span> sample functions, with a sampling frequency per function of <span class="math notranslate nohighlight">\(f_s = 1kHz\)</span>, for a signal duration of 5 seconds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span>  

<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">12</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">fs</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<section id="a-plot-the-ensemble-and-time-average-is-the-process-ergodic-in-the-mean">
<h3>a. plot the ensemble and time average. Is the process ergodic in the mean?<a class="headerlink" href="#a-plot-the-ensemble-and-time-average-is-the-process-ergodic-in-the-mean" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_ensamble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">x_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_ensamble</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ensamble Average&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_time</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Time Average&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_33_0.png" src="_images/Homework1_33_0.png" />
</div>
</div>
<p>The process is ergodic in the mean</p>
</section>
<section id="b-plot-the-ensemble-and-time-autocorrelation-function-is-the-process-ergodic-in-the-autocorrelation">
<h3>b. plot the ensemble and time autocorrelation function. Is the process ergodic in the autocorrelation?<a class="headerlink" href="#b-plot-the-ensemble-and-time-autocorrelation-function-is-the-process-ergodic-in-the-autocorrelation" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rxxu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">rxxt</span> <span class="o">=</span> <span class="n">rxxu</span><span class="o">/</span><span class="n">rxxu</span><span class="o">.</span><span class="n">size</span>
<span class="n">rxxe</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fs</span><span class="p">):</span>
    <span class="n">rxxe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">N</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxxe</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">]);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$Ensemble Average Autocorrelation$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$Time Average Autocorrelation$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxxt</span><span class="p">[</span><span class="mi">400</span><span class="p">:</span><span class="mi">500</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_37_0.png" src="_images/Homework1_37_0.png" />
</div>
</div>
<p>The process is ergodic in the autocorrelation</p>
</section>
</section>
<section id="id5">
<h2>5.<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h2>
<p>Simulate a white noise with a gaussian vector <span class="math notranslate nohighlight">\(X\)</span> with zero mean, <span class="math notranslate nohighlight">\(N_0 = 0.01W/Hz\)</span>,<span class="math notranslate nohighlight">\(fs = 2kHz\)</span>, and <span class="math notranslate nohighlight">\(N = 10000\)</span> samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">N_0</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">noise_power</span> <span class="o">=</span> <span class="n">N_0</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="mi">2</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_power</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;White noise with a gaussian vector $X$ with zero mean, $N_0 = 0.01W/Hz$,$fs = 2kHz$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;samples&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_40_0.png" src="_images/Homework1_40_0.png" />
</div>
</div>
<section id="a-find-the-autocorrelation-function-r-xx-using-signal-correlate-and-plot-the-result-compare-the-maximum-value-of-r-xx-with-the-noise-power-in-bandwidth-frac-f-s-cdot-n-0-2">
<h3>a. Find the autocorrelation function <span class="math notranslate nohighlight">\(R_{XX}(τ)\)</span>, using <code class="docutils literal notranslate"><span class="pre">signal.correlate</span></code>, and plot the result. Compare the maximum value of <span class="math notranslate nohighlight">\(R_{XX}(τ)\)</span> with the noise power in bandwidth: <span class="math notranslate nohighlight">\(\frac{f_s \cdot N_0}{2}\)</span><a class="headerlink" href="#a-find-the-autocorrelation-function-r-xx-using-signal-correlate-and-plot-the-result-compare-the-maximum-value-of-r-xx-with-the-noise-power-in-bandwidth-frac-f-s-cdot-n-0-2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">correlate</span> 

<span class="n">corr</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$R_</span><span class="si">{XX}</span><span class="s1">$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$samples$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Noise Power in Bandwidth (W) is fs·N0 / 2: </span><span class="si">{</span><span class="n">fs</span><span class="o">*</span><span class="n">N_0</span><span class="o">/</span><span class="mi">2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Max RXX(τ) is: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>            
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Noise Power (W/Hz): </span><span class="si">{</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">fs</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>   
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Noise Power dB: </span><span class="si">{</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Noise Power in Bandwidth (W) is fs·N0 / 2: 10.0
Max RXX(τ) is: 10.005
Noise Power (W/Hz): 0.010
Noise Power dB: -19.998
</pre></div>
</div>
<img alt="_images/Homework1_42_1.png" src="_images/Homework1_42_1.png" />
</div>
</div>
<p>The maximum value calculated from the autocorrelation is almost the same calculated from the noise power in bandwidth</p>
</section>
<section id="b-find-the-power-spectral-density-with">
<h3>b. Find the power spectral density with:<a class="headerlink" href="#b-find-the-power-spectral-density-with" title="Permalink to this headline">#</a></h3>
<p>\begin{equation}
S_{n n}=10 \log <em>{10}\left(\left|\mathcal{F}\left{R</em>{X X}(\tau)\right}\right|\left(2 / f_s\right)\right)
\end{equation}</p>
<p>using <code class="docutils literal notranslate"><span class="pre">fft</span></code>, from <code class="docutils literal notranslate"><span class="pre">scipy.fftpack</span></code>, and plot the result.
Compare the average noise power with the average from <code class="docutils literal notranslate"><span class="pre">psd</span></code> command from <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span>

<span class="n">Sxx</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">corr</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">fs</span><span class="p">))</span>

<span class="n">n_freq</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Sxx</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PSD From FFT&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_freq</span><span class="p">,</span> <span class="n">Sxx</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$S_</span><span class="si">{XX}</span><span class="s1">$&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Px_den</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">,</span> <span class="n">Fc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sides</span> <span class="o">=</span> <span class="s2">&quot;twosided&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PSD command with NFF=$2^</span><span class="si">{14}</span><span class="s1">$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">Fc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sides</span> <span class="o">=</span> <span class="s2">&quot;twosided&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PSD command&#39;</span><span class="p">);</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The mean of psd is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Px_den</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The mean of noise power is: </span><span class="si">{</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fs</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The mean of psd is: 0.0038331673155275227
The mean of noise power is: 0.005002358775044846
</pre></div>
</div>
<img alt="_images/Homework1_45_1.png" src="_images/Homework1_45_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_freq</span><span class="p">,</span> <span class="n">Sxx</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSD From FFT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">,</span> <span class="n">Fc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sides</span> <span class="o">=</span> <span class="s2">&quot;twosided&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSD command with NFF=$2^</span><span class="si">{14}</span><span class="s1">$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">Fc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sides</span> <span class="o">=</span> <span class="s2">&quot;twosided&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSD command&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x219c32ead90&gt;
</pre></div>
</div>
<img alt="_images/Homework1_46_1.png" src="_images/Homework1_46_1.png" />
</div>
</div>
</section>
</section>
<section id="id6">
<h2>6.<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h2>
<p>Generate a signal <span class="math notranslate nohighlight">\(X(t)\)</span>, a binary random sequence <span class="math notranslate nohighlight">\((X =
\{−2, +2\})\)</span> of <span class="math notranslate nohighlight">\(500\)</span> symbols, with <span class="math notranslate nohighlight">\(10\)</span> samples per symbol,
with <span class="math notranslate nohighlight">\(f_s = 1kHz\)</span> equivalent to <span class="math notranslate nohighlight">\(5\)</span> seconds of signal duration,
and power <span class="math notranslate nohighlight">\(P_X = 4\)</span> Watts. The signal <span class="math notranslate nohighlight">\(X(t)\)</span> pass through a
channel with AWGN, <span class="math notranslate nohighlight">\(Y(t) = X(t) + N(t)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">cant_symbols</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">random_symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">cant_symbols</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cant_symbols</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="n">fs</span>
<span class="c1">#t = np.linspace(0, T, (cant_symbols * N)) / fs</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">cant_symbols</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cant_symbols</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">random_symbols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="a-add-the-gaussian-noise-correspondent-to-a-snr-1db-and-plot-x-t-and-y-t">
<h3>a. Add the gaussian noise correspondent to a <span class="math notranslate nohighlight">\(SNR=-1dB\)</span>, and plot <span class="math notranslate nohighlight">\(X(t)\)</span>, and <span class="math notranslate nohighlight">\(Y(t)\)</span><a class="headerlink" href="#a-add-the-gaussian-noise-correspondent-to-a-snr-1db-and-plot-x-t-and-y-t" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random sequence between $X =\{−2, +2\}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t(s)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random sequence between $X =\{−2, +2\}$  zoom in&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span><span class="n">x</span><span class="p">[:</span><span class="mi">400</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t(s)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_50_0.png" src="_images/Homework1_50_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SNRdB</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">Px</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Pn</span> <span class="o">=</span> <span class="n">Px</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">SNRdB</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Noise power: </span><span class="si">{</span><span class="n">Pn</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> W&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N0: </span><span class="si">{</span><span class="p">(</span><span class="n">Pn</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">fs</span><span class="si">:</span><span class="s1">0.3e</span><span class="si">}</span><span class="s1"> W/Hz&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signal power: </span><span class="si">{</span><span class="n">Px</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> W&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signal duration: </span><span class="si">{</span><span class="n">T</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> s&#39;</span><span class="p">)</span>

<span class="n">noise</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pn</span><span class="p">))</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">noise</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random sequence between $X =\{−2, +2\}$ with noise&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$y(t)$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$x(t)$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t(s)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Random sequence between $X =\{−2, +2\}$ with noise zoom in&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span><span class="n">y</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$y(t)$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span><span class="n">x</span><span class="p">[:</span><span class="mi">400</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$x(t)$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t(s)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Noise power: 5.036 W
N0: 1.007e-02 W/Hz
Signal power: 4.000 W
Signal duration: 5.000 s
</pre></div>
</div>
<img alt="_images/Homework1_51_1.png" src="_images/Homework1_51_1.png" />
</div>
</div>
</section>
<section id="b-plot-the-autocorrelation-functions-r-xx-and-r-yy">
<h3>b. Plot the autocorrelation functions <span class="math notranslate nohighlight">\(R_{XX}\)</span> and <span class="math notranslate nohighlight">\(R_{YY}\)</span><a class="headerlink" href="#b-plot-the-autocorrelation-functions-r-xx-and-r-yy" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">correlate</span> 

<span class="n">window</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span>

<span class="n">corr_x</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">size</span>
<span class="n">center_tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">window</span><span class="p">,</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="n">window</span><span class="p">)</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">window</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">corr_y</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">size</span>
<span class="n">center_tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">window</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="n">window</span><span class="p">)</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">window</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">corr_y</span><span class="p">[</span><span class="n">center_tau</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$R_</span><span class="si">{YY}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">corr_x</span><span class="p">[</span><span class="n">center_tau</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$R_</span><span class="si">{XX}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\tau$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_53_0.png" src="_images/Homework1_53_0.png" />
</div>
</div>
</section>
<section id="c-plot-the-power-spectral-densities-s-xx-and-s-yy">
<h3>c. Plot the power spectral densities <span class="math notranslate nohighlight">\(S_{XX}\)</span>, and <span class="math notranslate nohighlight">\(S_{YY}\)</span>.<a class="headerlink" href="#c-plot-the-power-spectral-densities-s-xx-and-s-yy" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
<span class="n">Py_den</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">Fc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sides</span> <span class="o">=</span> <span class="s2">&quot;onesided&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$S_</span><span class="si">{YY}</span><span class="s1">$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">Fc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sides</span> <span class="o">=</span> <span class="s2">&quot;onesided&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;$S_</span><span class="si">{XX}</span><span class="s1">$&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>


<span class="n">Pn</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">corr_y</span><span class="p">)</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">corr_x</span><span class="p">)</span>
<span class="n">Px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">corr_x</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ideal SNR: </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Simulated Noise Power: </span><span class="si">{</span><span class="n">Pn</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> W&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Simulated SNR: </span><span class="si">{</span><span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Px</span><span class="o">/</span><span class="n">Pn</span><span class="p">)</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signal + noise power: </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">corr_y</span><span class="p">)</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1"> W&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;From PSD: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Py_den</span><span class="p">)</span><span class="o">*</span><span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ideal SNR: -1.000 dB
Simulated Noise Power: 5.036 W
Simulated SNR: -1.000 dB
Signal + noise power: 9.036 W
From PSD: 9.320
</pre></div>
</div>
<img alt="_images/Homework1_55_1.png" src="_images/Homework1_55_1.png" />
</div>
</div>
</section>
</section>
<section id="id7">
<h2>7.<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(x(t)\)</span> be the received signal with noise, where <span class="math notranslate nohighlight">\(n \sim\)</span> <span class="math notranslate nohighlight">\(N(0, \sigma=0.05)\)</span></p>
<p>\begin{equation}
x(t)=0.5 \sin (2 \pi 20 t)+0.3 \sin (2 \pi 80 t)+n(t)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="n">fs</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># signal</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> 

<span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">80</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span>
</pre></div>
</div>
</div>
</div>
<section id="a-determine-the-coefficients-of-the-ar-4-estimator-of-x-t-using-the-yule-walker-equations">
<h3>a. Determine the coefficients of the <span class="math notranslate nohighlight">\(AR(4)\)</span> estimator of <span class="math notranslate nohighlight">\(x(t)\)</span>, using the Yule Walker equations<a class="headerlink" href="#a-determine-the-coefficients-of-the-ar-4-estimator-of-x-t-using-the-yule-walker-equations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="n">rx</span> <span class="o">=</span> <span class="n">rx</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>

<span class="n">K</span><span class="o">=</span><span class="mi">10</span>
<span class="n">low</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span>
<span class="n">high</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="n">K</span>
<span class="n">acf</span> <span class="o">=</span> <span class="n">rx</span><span class="p">[</span><span class="n">low</span><span class="p">:</span><span class="n">high</span><span class="p">]</span>

<span class="n">r1</span><span class="o">=</span><span class="n">acf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">r2</span><span class="o">=</span><span class="n">acf</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">r3</span><span class="o">=</span><span class="n">acf</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">r4</span><span class="o">=</span><span class="n">acf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> 

<span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">r3</span><span class="p">],</span>
             <span class="p">[</span><span class="n">r1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">],</span>
             <span class="p">[</span><span class="n">r2</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">r1</span><span class="p">],</span>
             <span class="p">[</span><span class="n">r3</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="n">r1</span><span class="p">],[</span><span class="n">r2</span><span class="p">],[</span><span class="n">r3</span><span class="p">],[</span><span class="n">r4</span><span class="p">]])</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rx:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estimated coefficients AR(4):</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rx:

[[ 1.          0.36978392  0.30603663 -0.14445651]
 [ 0.36978392  1.          0.36978392  0.30603663]
 [ 0.30603663  0.36978392  1.          0.36978392]
 [-0.14445651  0.30603663  0.36978392  1.        ]]

b:

[[ 0.36978392]
 [ 0.30603663]
 [-0.14445651]
 [-0.79400904]]

Estimated coefficients AR(4):

[[ 0.00870244]
 [ 0.60480193]
 [-0.01062834]
 [-0.97391327]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-plot-the-estimated-psd-psd-command-and-the-parametric-psd-from-yule-walker-equations">
<h3>b. Plot the estimated PSD (<code class="docutils literal notranslate"><span class="pre">psd</span></code> command), and the parametric PSD from Yule Walker equations<a class="headerlink" href="#b-plot-the-estimated-psd-psd-command-and-the-parametric-psd-from-yule-walker-equations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">freqz</span>

<span class="n">a</span><span class="o">=</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>

<span class="p">[</span><span class="n">w</span><span class="p">,</span><span class="n">H</span><span class="p">]</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original PSD&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Parametric PSD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Homework1_61_0.png" src="_images/Homework1_61_0.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Universidad de Antioquia<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>